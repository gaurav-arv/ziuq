<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('select');
    var instances = M.FormSelect.init(elems, 'dropdownOptions');
  });
  var fname = '';
  var lname = '';

 function addTag(){
 	var fname = document.getElementById('fname').value
 	var lname = document.getElementById('lname').value

    document.getElementById('demo').innerHTML ='<li class="collection-item" id=\'e1\' onclick="v1(\'testid1\');" style="background-color: #e8f5e9;">Section 1<li>'+
        '<li class="collection-item" id=\'e2\' onclick="v1(\'testid2\');" style="background-color: #e8f5e9;">Section 2</li>'+
        '<li class="collection-item" id=\'e3\' onclick="v1(\'testid3\');" style="background-color: #e8f5e9;">Section 3</li>'+
        '<li class="collection-item" id=\'e4\' onclick="v1(\'testid4\');" style="background-color: #e8f5e9;">Section 4</li>'
        document.getElementById('instructionSubmit').disabled = true;
    document.getElementById('i1').remove();
    v1('testid1');
  }

  //  window.addEventListener('blur',function(){alert('Thank You for Appearing');window.onfocus = window.close();});

</script>
<style>
body{
    padding: 0;
    margin: 0;
}

.collection-item{
    cursor: pointer;
    text-align: center;
}

.leaveMargin{
    margin-left: 20px;
    z-index: -1;


}
.tabContent{
            position: absolute;
            top: 0;
            width: 65vw;
}
div {
    word-wrap: break-word;
}
.loader-wrapper{
    position: absolute;
    width: 100%;
    height: 100vh;
    background: red;
    z-index: 999999;
}
</style>
</head>
<body style="background: #efefef;">

<!-- Page Layout here -->
<div class="row" style="padding: 0;margin: 0;font-family: Montserrat;">

    <div class="col s3" style="background-color:#bbdefb; height: 100vh; position: fixed;">
    <div class="row">
    <h1><img class="for_default" style="align-self: center;margin-left: 20px" src="https://d3rv1nmzvje89q.cloudfront.net/optimized_v5/2017/02/logo_optimize-1024x310.png" width="90%" height="90%" alt=""></h1>
    <ul class="collection">
        <li class="collection-item" id='i1' onclick="v1('instruction');"style="background-color: #e8f5e9;">Instructions for the Test<li></li>
        <p id='demo'></p>
    </ul>
    </div>
    </div>
    <div class="col s9 offset-s3" id="newId1" style="background-color: #efefef; position: relative;">

      
    <div class="row tabContent" style="margin-left: 50px; background-color: #efefef;" id="testid1" width="100%" height=100% >
        <ul>
            <li><h5 style="text-align: center; background-color: #d1c4e9 ;" class='card-panel '>Section 1</h5></li>
            <li>

            </li>
        </ul>
       <!-- <input type="submit" class="submit"> -->
    </div>
    <div class="row tabContent" style="margin-left: 50px; background-color: #efefef;" id="newid1" width="100%" height=100% >
        <ul>
            <li><h5 style="text-align: center; background-color: #d1c4e9 ;" class='card-panel '>Section 1</h5></li>
            <li>

            </li>
        </ul>
       <!-- <input type="submit" class="submit"> -->
    </div>    
    <div class="row tabContent" style="margin-left: 50px; background-color: #efefef;" id="testid2" width="100%" height=100% >
        <ul>
            <li><h5 style="text-align: center; background-color: #d1c4e9 ;" class='card-panel'>Section 2</h5></li>
        </ul>   
    </div>   
    <div class="row tabContent" style="margin-left: 50px; background-color: #efefef;" id="testid3" width="100%" height=100% >
        <ul>
            <li><h5 style="text-align: center; background-color: #d1c4e9 ;" class='card-panel'>Section 3</h5></li>
        </ul>
    </div>   
    <div class="row tabContent" style="margin-left: 50px; background-color: #efefef;" id="testid4" width="100%" height=100%>
        <ul>
            <li ><h5 style="text-align: center; background-color: #d1c4e9 ;" class="card-panel">Section 4</h5></li>      
        </ul>
    </div>
    <div class="row tabContent card-panel indigo lighten-5" id="instruction" style="margin-left: 50px; height: 100vh; margin-left: 50px; display: block; background-color: #efefef; position: initial;" width="100%" height=100% >
        <ul>
         <li><h5 style="text-align: center;" class='card-panel'>Instructions</h5></li>
            <li>
             <div class="input-field">
                 <input type="text" class="text">
                 <label style="color: black;" for="text" id="fname" class="text">First Name</label><br>
             </div>
            </li>
            <li>
             <div class="input-field">
                 <input type="text" class="text">
                 <label style="color: black;" for="text" id="lname" class="text">Last Name</label><br>
             </div>
            </li>
            <li>
                <input style="align-content: center;" id="instructionSubmit"type="submit" onclick="addTag()" value="submit">
            </li>
            <li>
                <ul style="display: block;">
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
            </li>
        </ul>     
</div> 
    </div>       
</div>
<script>
	function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
var idtoken = getCookie('idtoken')
if(!idtoken){
	let temp = window.location.href.split('/')
    temp[temp.length-1]=''
    window.location.href= temp.join('/')
}
	var mainTimer = 0
	var mainSection = 0
	var mainTimer1 = 0
	var mainTimer2 = 0
   	var mainTimer3 = 0
   	var mainTimer4 = 0
   	var tempTimer = new Date()
   	var previous = "instruction"
   	v1()
    //display section individually
    function v1(e){
        if(previous=="instruction"){
            var timeSpent = new Date().getTime() - tempTimer.getTime()
            mainSection += timeSpent
            tempTimer = new Date()
        }else if(previous=="testid1"){
            var timeSpent = new Date().getTime() - tempTimer.getTime()
            mainTimer1 += timeSpent
            tempTimer = new Date()
        }else if(previous=="testid2"){
            var timeSpent = new Date().getTime() - tempTimer.getTime()
            mainTimer2 += timeSpent
            tempTimer = new Date()
        }else if(previous=="testid3"){
            var timeSpent = new Date().getTime() - tempTimer.getTime()
            mainTimer3 += timeSpent
            tempTimer = new Date()
        }else if(previous=="testid4"){
            var timeSpent = new Date().getTime() - tempTimer.getTime()
            mainTimer4 += timeSpent
            tempTimer = new Date()
        }
        if(e=="instruction"){
            previous = "instruction"
        }
        if(e=="testid1"){
            previous = "testid1"
        }
        if(e=="testid2"){
            previous = "testid2"
        }
        if(e=="testid3"){
            previous = "testid3"
        }
        if(e=="testid4"){
            previous = "testid4"
        }
    var a = document.querySelectorAll('.tabContent')
    for(var i=0;i<a.length;i++){
        a[i].style.display='none'
        }
        document.getElementById(e).style.display = "block";
    }
</script>
<script>
    var section1Answer=[],section2Answer=[],section3Answer=[],section4Answer=[];
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
           // Typical action to be performed when the document is ready:
            question = JSON.parse(xhttp.responseText);
            addSection1Q(question.section1,'testid1');

            sectionSubmit('testid1');
            document.querySelector('#sectiontestid1').addEventListener('click',function(e){;
                document.querySelector('#sectiontestid1').disabled = true;
                sectionCollect('testid1', question , 1, section1Answer);
                document.getElementById('testid1').remove();
                document.getElementById('e1').remove();
                ThankYou();
                })
            
            addSection1Q(question.section2,'testid2');
            sectionSubmit('testid2');
             
            document.querySelector('#sectiontestid2').addEventListener('click',function(e){
                document.querySelector('#sectiontestid2').disabled = true;
                sectionCollect('testid2', question , 2, section2Answer);
                document.getElementById('testid2').remove();
                document.getElementById('e2').remove();
                ThankYou();
                }) 
            
            addSection1Q(question.section3,'testid3');
            sectionSubmit('testid3');
            document.querySelector('#sectiontestid3').addEventListener('click',function(e){
                document.querySelector('#sectiontestid3').disabled = true;
                sectionCollect('testid3', question , 3, section3Answer);
                document.getElementById('testid3').remove();
                document.getElementById('e3').remove();
                ThankYou();
                })

            addSection1Q(question.section4,'testid4')
            sectionSubmit('testid4');
            document.querySelector('#sectiontestid4').addEventListener('click',function(e){
                document.querySelector('#sectiontestid4').disabled = true;
                sectionCollect('testid4', question , 4, section4Answer);
                document.getElementById('testid4').remove();
                document.getElementById('e4').remove();
                ThankYou();
                })
            //    v1('instructions');
            // v1();
            //v1('instruction');  
        }
    };
    xhttp.open("GET", "https://script.google.com/macros/s/AKfycbwbpxuAwdbXxGVM9LiLkw2mIwwSuWPE91XThCW4j-I70H58fXE/exec", true);
    xhttp.send();
     //Dynamically adding questions:
    function addSection1Q(ss,testid){
        
        var section3 = ss;
        for(var i=0;i<section3.length;i++){
            if(section3[i][0] == 'MCQ'){
                addMCQ(section3[i],testid);
            }
            if(section3[i][0] == 'Subjective'){
                addSubjective(section3[i],testid)
            }
            if(section3[i][0] == 'Dropdown'){ ;
                addDropDown(section3[i],testid)
            }
        }
    }
    function addMCQ(questions,testid){
        var parent_node = document.getElementById(testid);
        var new_element = document.createElement('div');
        var htmlcode = '<li style="list-style: none;" class="card-panel indigo lighten-5 '+testid+' MCQ">'+questions[1]+'<br><br>';
        for(var i=2;i<questions.length;i++){
            htmlcode += '<label>'+
                  '<input class="with-gap" name="group' + questions[1].substr(0,3) + testid + '" type="radio"  />'+
                  '<span style="color: black;">'+questions[i]+'</span><br>'+
                  '</label><br>'
        }
        htmlcode += '</li> ';
        new_element.innerHTML=htmlcode;
        parent_node.appendChild(new_element);
    }
    function addSubjective(questions,testid){ ;
        var parent_node = document.getElementById(testid);
        var new_element = document.createElement('div');
        var htmlcode = '<li style="list-style: none;"  class="card-panel blue lighten-5 '+testid+' subjective">' + questions[1].substr(0,3) +'<br><input type="text" class="text '+testid+' Subjective">'+
                '<label style="color: black;" for="text" class="text"></label><br>';
        /* for(var i=2;i<questions.length;i++){
            htmlcode += '<label>'+
                  '<input class="with-gap" name="group3" type="radio" checked />'+
                  '<span style="color: black;">'+questions[i]+'</span><br>'+
                  '</label><br>'
        } */
        htmlcode += '</li> ';
        new_element.innerHTML=htmlcode;
         ;
        parent_node.appendChild(new_element);
    }
    function addDropDown(questions,testid){ ;
        var parent_node = document.getElementById(testid);
        var new_element = document.createElement('div');
        var htmlcode = '<li class="card-panel blue lighten-5" style="list-style: none;"><div class="col s12" style="float: none">'+questions[1]+'<br><br><select class="browser-default '+testid+' dropdown"><option value="" disabled="" selected="">Choose your option</option>';
            for(var i=2;i<questions.length;i++){
                htmlcode +='<option value='+questions[i]+'>'+questions[i]+'</option>'
            }
            htmlcode += '</select></div></li>';   
            new_element.innerHTML=htmlcode;
            parent_node.appendChild(new_element);

    }
    function sectionSubmit(testid){ ;
        var parent_node = document.getElementById(testid);
        var new_element = document.createElement('div');
        var htmlcode = '<input type="submit" name="submit'+testid+'"  id="section'+testid+'"  class="submit">';
        new_element.innerHTML=htmlcode;
        parent_node.appendChild(new_element);
    }
    // Functions for data collection from user
    function sectionCollect(testid, obj,section,sectionpush){ ;
        console.log(obj)
        var value = 0;
        var dvalue = 0;
        var svalue = 0;
        if(section == 1){var questions = obj.section1;}
        if(section == 2){var questions = obj.section2;}
        if(section == 3){var questions = obj.section3;}
        if(section == 4){var questions = obj.section4;}
        for(var i=0;i<questions.length ; i++){
            var q = questions[i];
            if(q[0] == 'MCQ'){;
                var a = MCQcollect(testid,q,section,value);
                sectionpush.push(a)
                value++;
            }else if(q[0] == 'Dropdown'){;
                var a = DropDownCollect(testid,q,dvalue);
                sectionpush.push(a)
                dvalue++;
            }else{;
                var a = SubjectiveCollect(testid,svalue);
                svalue++;
                sectionpush.push(a);
            }
        }
    }
    function DropDownCollect(testid,q,dvalue){;;
        var a = document.querySelectorAll('select.'+testid)
        a = a[dvalue];
        a=a.value; ;
        return a;
    }
    function SubjectiveCollect(testid,svalue){;
        return document.querySelectorAll('input.'+testid+'.Subjective')[svalue].value;
    }
    function MCQcollect(testid,questions,section,value){;; ;
        var a = document.querySelectorAll('.'+testid+'.MCQ')[value].querySelectorAll('input')
        for(var i=0; i <questions.length-2 ;i++){ ;
        if(a[i].checked){                
            return a[i].nextElementSibling.innerText;       
            }
        };;
    }

    function ThankYou(){
        var a = document.querySelectorAll('.collection-item');
        if(a.length==0){
            var parent_node = document.getElementById('newid1');
            var new_element = document.createElement('div');
            var htmlcode = '<li style="list-style: none;"  class="card-panel blue lighten-5 ">Thank You For Appearing<br><br>';;
            new_element.innerHTML=htmlcode;
            parent_node.appendChild(new_element);
        }
    }



</script>
<!-- Code injected by live-server -->
<script type="text/javascript">
// <![CDATA[ <-- For SVG support
if ('WebSocket' in window) {
(function () {
function refreshCSS() {
var sheets = [].slice.call(document.getElementsByTagName("link"));
var head = document.getElementsByTagName("head")[0];
for (var i = 0; i < sheets.length; ++i) {
var elem = sheets[i];
var parent = elem.parentElement || head;
parent.removeChild(elem);
var rel = elem.rel;
if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
}
parent.appendChild(elem);
}
}
var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
var address = protocol + window.location.host + window.location.pathname + '/ws';
var socket = new WebSocket(address);
socket.onmessage = function (msg) {
if (msg.data == 'reload') window.location.reload();
else if (msg.data == 'refreshcss') refreshCSS();
};
if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
console.log('Live reload enabled.');
sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
}
})();
}
else {
console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
}
// ]]>
</script>

</body>
</html>
